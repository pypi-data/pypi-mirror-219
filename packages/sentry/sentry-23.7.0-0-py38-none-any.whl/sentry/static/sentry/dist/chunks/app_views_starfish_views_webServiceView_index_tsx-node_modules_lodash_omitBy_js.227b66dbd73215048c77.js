(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_starfish_views_webServiceView_index_tsx-node_modules_lodash_omitBy_js"],{"./app/components/performance/layouts.tsx":(t,e,r)=>{"use strict";r.d(e,{c:()=>n});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),i=r("./app/styles/space.tsx");const n=(0,s.Z)("div",{target:"eufzkx60"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,i.D)(2),";grid-row-gap:",(0,i.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(t=>t.theme.breakpoints.medium),"){",(t=>t.columns?`\n    grid-template-columns: repeat(${t.columns}, 1fr);\n    `:`\n    grid-template-columns: repeat(auto-fit, minmax(${t.minSize}px, 1fr));\n    `),";}")},"./app/utils/performance/contexts/pageError.tsx":(t,e,r)=>{"use strict";r.d(e,{De:()=>c,V_:()=>o,YY:()=>l});var s=r("../node_modules/react/index.js"),i=r("./app/components/alert.tsx"),n=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const a=(0,s.createContext)({pageError:void 0,setPageError:t=>{}});function o(t){let{children:e}=t;const[r,i]=(0,s.useState)();return(0,n.tZ)(a.Provider,{value:{pageError:r,setPageError:i},children:e})}function l(){const{pageError:t}=(0,s.useContext)(a);return t?(0,n.tZ)(i.bZ,{type:"error","data-test-id":"page-error-alert",showIcon:!0,children:t}):null}o.displayName="PageErrorProvider",l.displayName="PageErrorAlert";const c=()=>(0,s.useContext)(a)},"./app/views/starfish/components/starfishProjectSelector.tsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>m}),r("../node_modules/core-js/modules/es.error.cause.js");var s=r("./app/actionCreators/pageFilters.tsx"),i=r("./app/components/compactSelect/index.tsx"),n=r("./app/components/idBadge/projectBadge.tsx"),a=r("./app/locale.tsx"),o=r("./app/utils/useOrganization.tsx"),l=r("./app/utils/usePageFilters.tsx"),c=r("./app/utils/useProjects.tsx"),p=r("./app/utils/useRouter.tsx");const d={sentry:["1","300688"],codecov:["5215654"],peated:["4505138082349056"]};var u=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(){const{projects:t,initiallyLoaded:e,fetchError:r}=(0,c.Z)(),n=(0,o.Z)(),{selection:m,isReady:g}=(0,l.Z)(),f=(0,p.Z)();if(!e||!g)return(0,u.tZ)(i.Z,{disabled:!0,options:[{label:(0,a.t)("Loadingâ€¦"),value:"loading"}],defaultValue:"loading"});if(r)throw new Error("Failed to fetch projects");const x=d[n.slug]??[],v=t.filter((t=>x.includes(t.id))).map((t=>({label:(0,u.tZ)(h,{project:t}),value:t.id}))),Z=v.find((t=>m.projects.includes(parseInt(t.value,10))))??v[0],y=t=>(0,s.id)([parseInt(t.value,10)],f,{save:!0});return(m.projects.length>1||!x.includes(`${m.projects[0]}`))&&y(v[0]),(0,u.tZ)(i.Z,{menuWidth:250,options:v,defaultValue:Z?.value,onChange:y})}function h(t){let{project:e}=t;return(0,u.tZ)(n.Z,{project:e,avatarSize:20,disableLink:!0})}m.displayName="StarfishProjectSelector",h.displayName="ProjectOptionLabel"},"./app/views/starfish/components/tableCells/throughputCell.tsx":(t,e,r)=>{"use strict";r.d(e,{Z:()=>o});var s=r("./app/locale.tsx"),i=r("./app/utils/discover/styles.tsx"),n=r("./app/utils/formatters.tsx"),a=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function o(t){let{throughputPerSecond:e,containerProps:r}=t;const o=e?(0,n.Du)(e):"--";return(0,a.BX)(i.Hw,{...r,children:[o,"/",(0,s.t)("s")]})}o.displayName="ThroughputCell"},"./app/views/starfish/views/webServiceView/index.tsx":(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>Ct});var s=r("../node_modules/react/index.js"),i=r("../node_modules/lodash/isEqual.js"),n=r.n(i),a=r("./app/actionCreators/tags.tsx"),o=r("./app/components/organizations/pageFilters/container.tsx"),l=r("./app/components/sentryDocumentTitle.tsx"),c=r("./app/locale.tsx"),p=r("./app/utils/performance/contexts/metricsEnhancedSetting.tsx"),d=r("./app/utils/useApi.tsx"),u=r("./app/utils/useOrganization.tsx"),m=r("./app/utils/usePrevious.tsx"),h=r("./app/utils/withPageFilters.tsx"),g=r("./app/components/gridEditable/index.tsx"),f=r("./app/components/performance/searchBar.tsx"),x=r("./app/utils/discover/eventView.tsx"),v=r("./app/utils/discover/types.tsx"),Z=r("./app/utils/queryString.tsx"),y=r("./app/utils/tokenizeSearch.tsx");const w=["transaction"],b="time_spent_percentage()",_=t=>t?.features?.includes("performance-landing-page-stats-period")?"14d":"7d";var j=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),S=r("./app/components/layouts/thirds.tsx"),k=r("./app/components/organizations/pageFilterBar.tsx"),P=r("./app/styles/space.tsx"),C=r("./app/utils/performance/contexts/pageError.tsx"),E=r("./app/views/starfish/components/datePicker.tsx"),F=r("./app/views/starfish/components/starfishProjectSelector.tsx"),B=r("./app/components/charts/eventsRequest.tsx"),q=r("./app/components/performance/layouts.tsx"),z=r("./app/constants/chartPalette.tsx"),D=r("../node_modules/@emotion/react/dist/emotion-element-6a883da9.browser.esm.js"),T=r("./app/components/charts/utils.tsx"),L=r("./app/utils/discover/charts.tsx"),N=r("./app/utils/usePageFilters.tsx"),V=r("./app/utils/withApi.tsx"),X=r("./app/views/starfish/colours.tsx"),O=r("./app/views/starfish/components/chart.tsx"),R=r("./app/components/panels/panel.tsx"),$=r("./app/styles/text.tsx"),A=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function M(t){let{title:e,children:r,button:s,subtitle:i}=t;return(0,A.tZ)(R.Z,{children:(0,A.BX)(Q,{children:[(0,A.BX)(W,{children:[(0,A.BX)(I,{children:[e&&(0,A.tZ)(Y,{children:e}),s]}),i&&(0,A.tZ)(G,{children:i})]}),r]})})}M.displayName="MiniChartPanel";const Y=(0,j.Z)("p",{target:"e1mibtmj4"})((t=>t.theme.text.cardTitle),";"),W=(0,j.Z)("div",{target:"e1mibtmj3"})("padding:0 ",(0,P.D)(1)," ",(0,P.D)(1)," 0;"),I=(0,j.Z)("div",{target:"e1mibtmj2"})({name:"gt3bih",styles:"min-height:24px;width:100%;display:flex;align-items:center;justify-content:space-between"}),Q=(0,j.Z)("div",{target:"e1mibtmj1"})("padding:",(0,P.D)(1.5)," ",(0,P.D)(2),";",$.Z,";"),G=(0,j.Z)("span",{target:"e1mibtmj0"})("color:",(t=>t.theme.gray300),";font-size:",(t=>t.theme.fontSizeMedium),";display:inline-block;");var H=r("./app/views/starfish/utils/chartValueFormatters/formatThroughput.ts"),K=r("./app/views/starfish/utils/constants.tsx"),J=r("./app/views/starfish/views/spans/types.tsx"),U=r("./app/views/starfish/views/webServiceView/spanGroupBreakdownContainer.tsx"),tt=r("../node_modules/query-string/index.js"),et=r("./app/components/assistant/guideAnchor.tsx"),rt=r("./app/components/duration.tsx"),st=r("./app/components/gridEditable/sortLink.tsx"),it=r("./app/components/links/link.tsx"),nt=r("./app/components/pagination.tsx"),at=r("./app/components/searchBar.tsx"),ot=r("./app/components/tooltip.tsx"),lt=r("./app/utils/analytics.tsx"),ct=r("./app/utils/discover/discoverQuery.tsx"),pt=r("./app/utils/discover/fieldRenderers.tsx"),dt=r("./app/utils/discover/fields.tsx"),ut=r("./app/utils/discover/styles.tsx"),mt=r("./app/utils/formatters.tsx"),ht=r("./app/views/starfish/components/tableCells/throughputCell.tsx");const gt=[(0,c.t)("Endpoint"),J.F.throughput,(0,c.t)("Change"),J.F.p95,(0,c.t)("Change"),J.F.errorCount,(0,c.t)("Change"),J.F.timeSpent];function ft(t){let{eventView:e,location:r,organization:i,setError:n}=t;const[a,o]=(0,s.useState)([]),[l,p]=(0,s.useState)(e);function d(t){const s={};return t?.data?.[0]&&Object.keys(t.data[0]).forEach((t=>{t.startsWith("equation|(percentile_range(transaction.duration,0.95,lessOrEquals")&&(s["p95()"]=t)})),(s,n)=>function(t,s,n,a){if(!t||!t.meta)return n[s.key];const o=t.meta,l=String(s.key),p=(0,pt.Js)(l,o,!1)(n,{organization:i,location:r});if("transaction"===l){let t="";return n["http.method"]&&(t=`${n["http.method"]} `),(0,A.BX)(it.Z,{to:`/organizations/${i.slug}/starfish/endpoint-overview/?${tt.stringify({endpoint:n.transaction,"http.method":n["http.method"],statsPeriod:e.statsPeriod,project:e.project,start:e.start,end:e.end})}`,style:{display:"block",width:"100%"},onClick:()=>{(0,lt.Gi)("starfish.web_service_view.endpoint_list.endpoint.clicked",{organization:i,endpoint:n.transaction})},children:[t,n.transaction]})}if(l===b){const t=Number(n["sum(transaction.duration)"]),e=Number(n[b]);return(0,A.tZ)(ot.u,{title:(0,c._N)("Total time spent by endpoint is [cumulativeTime])",{cumulativeTime:(0,A.tZ)(rt.Z,{seconds:t/1e3,fixedDigits:2,abbreviation:!0})}),containerDisplayMode:"block",position:"top",children:(0,A.tZ)(ut.Hw,{children:(0,mt.rl)(e)})})}if("tps()"===l)return(0,A.tZ)(ht.Z,{throughputPerSecond:n[l]});if("project"===l)return null;const d=(0,dt.LY)(l),u=n[d];return"integer"===o[d]&&"number"==typeof u&&u>999?(0,A.tZ)(ot.u,{title:u.toLocaleString(),containerDisplayMode:"block",position:"right",children:p}):p}(t,s,n)}function u(t){const s=gt;return(n,a)=>function(t,s,n){let a="right";"Endpoint"===n&&(a="left");const o={field:"equation"===s.column.kind?s.key:s.name,width:s.width},l={};t&&Object.keys(t).forEach((e=>{l[(0,dt.LY)(e)]=t[e]}));const c=e.sortForField(o,l),p=(0,x.M3)(o,l),d=c?c.kind:void 0;return(0,A.tZ)(st.Z,{align:a,title:n||o.field,direction:d,canSort:p,generateSortLink:function(){if(!t)return;const s=e.sortOnField(o,l).generateQueryStringObject();return{...r,query:{...r.query,sort:s.sort}}},onClick:()=>{(0,lt.Gi)("starfish.web_service_view.endpoint_list.header.clicked",{organization:i,direction:"desc"===d?"asc":"desc",header:n||o.field})}})}(t,n,s[a])}function m(t,e){o((r=>r.map(((r,s)=>s===t?Number(e.width??g.z7):r))))}(0,s.useEffect)((()=>{p((t=>{const r=e.clone();return r.query=t.query,r}))}),[e]);const h=e.getColumns().filter((t=>"project"!==t.name&&"http.method"!==t.name&&"total.transaction_duration"!==t.name&&"sum(transaction.duration)"!==t.name)).map(((t,e)=>"number"==typeof a[e]?{...t,width:a[e]}:t)),f=e.getSorts();return(0,A.BX)(et.Z,{target:"performance_table",position:"top-start",children:[(0,A.tZ)(vt,{placeholder:(0,c.t)("Search for endpoints"),onSearch:function(t){const r=e.clone();r.query+=`transaction:*${t}*`,p(r),(0,lt.Gi)("starfish.web_service_view.endpoint_list.search",{organization:i,query:t})}}),(0,A.tZ)(ct.Z,{eventView:l,orgSlug:i.slug,location:r,setError:t=>n(t?.message),referrer:"api.starfish.endpoint-list",queryExtras:{dataset:"metrics"},children:t=>{let{pageLinks:e,isLoading:i,tableData:n}=t;return(0,A.BX)(s.Fragment,{children:[(0,A.tZ)(g.ZP,{isLoading:i,data:n?n.data:[],columnOrder:h,columnSortBy:f,grid:{onResizeColumn:m,renderHeadCell:u(n?.meta),renderBodyCell:d(n)},location:r}),(0,A.tZ)(nt.Z,{pageLinks:e})]})}})]})}ft.displayName="EndpointList";const xt=ft,vt=(0,j.Z)(at.Z,{target:"e152i1y80"})("margin-bottom:",(0,P.D)(2),";"),Zt=(0,V.Z)(B.Z);function yt(t){const{organization:e,eventView:r}=t,i=(0,N.Z)(),n=(0,D.u)();return(0,O.K4)(),(0,A.BX)("div",{"data-test-id":"starfish-view",children:[(0,A.tZ)(wt,{minSize:300,children:(0,A.BX)(bt,{children:[(0,A.tZ)(_t,{children:(0,A.tZ)(U._2,{})}),(0,A.tZ)(jt,{children:function(){const t=new y.MY(["event.type:transaction","has:http.method","transaction.op:http.server"]);return(0,A.tZ)(Zt,{query:t.formatString(),includePrevious:!1,partial:!0,interval:(0,T.ZS)(i.selection.datetime,K.R),includeTransformedData:!0,limit:1,environment:r.environment,project:r.project,period:r.statsPeriod,referrer:"api.starfish-web-service.homepage-charts",start:r.start,end:r.end,organization:e,yAxis:["tps()","http_error_count()","p95(transaction.duration)"],dataset:v.as.METRICS,children:t=>{let{loading:e,results:i}=t;if(!i||!i[0]||!i[1])return null;const a={seriesName:(0,c.t)("Requests"),data:i[0].data},o={seriesName:(0,c.t)("5XX Responses"),color:z.$[5][3],data:i[1].data},l={seriesName:(0,c.t)("Requests"),data:i[2].data};return(0,A.BX)(s.Fragment,{children:[(0,A.tZ)(M,{title:J.F.p95,children:(0,A.tZ)(O.ZP,{statsPeriod:r.statsPeriod,height:71,data:[l],start:r.start,end:r.end,loading:e,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:2,isLineChart:!0,chartColors:[X.Tn],tooltipFormatterOptions:{valueFormatter:t=>(0,L.Ew)(t,"duration")}})}),(0,A.tZ)(M,{title:J.F.throughput,children:(0,A.tZ)(O.ZP,{statsPeriod:r.statsPeriod,height:71,data:[a],start:"",end:"",loading:e,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},aggregateOutputFormat:"rate",definedAxisTicks:2,stacked:!0,isLineChart:!0,chartColors:[X.SQ],tooltipFormatterOptions:{valueFormatter:t=>(0,H.Z)(t)}})}),(0,A.tZ)(M,{title:J.F.errorCount,children:(0,A.tZ)(O.ZP,{statsPeriod:r.statsPeriod,height:71,data:[o],start:r.start,end:r.end,loading:e,utc:!1,grid:{left:"0",right:"0",top:"8px",bottom:"0"},definedAxisTicks:2,isLineChart:!0,chartColors:n.charts.getColorPalette(2)})})]})}})}()})]})}),(0,A.tZ)(xt,{...t,setError:(0,C.De)().setPageError})]})}yt.displayName="StarfishView";const wt=(0,j.Z)(q.c,{target:"epbipxo3"})("margin-bottom:",(0,P.D)(2),";"),bt=(0,j.Z)("div",{target:"epbipxo2"})("display:flex;flex-direction:row;flex-wrap:wrap;gap:",(0,P.D)(2),";"),_t=(0,j.Z)("div",{target:"epbipxo1"})({name:"1189xqs",styles:"flex:2"}),jt=(0,j.Z)("div",{target:"epbipxo0"})({name:"82a6rk",styles:"flex:1"});function St(t){const e=(0,A.BX)(k.Z,{condensed:!0,children:[(0,A.tZ)(F.Z,{}),(0,A.tZ)(E.Z,{})]});return(0,A.tZ)(S.T3,{children:(0,A.BX)(C.V_,{children:[(0,A.tZ)(S.h4,{children:(0,A.tZ)(S.oB,{children:(0,A.tZ)(S.Dx,{children:(0,c.t)("Web Service")})})}),(0,A.tZ)(S.uT,{children:(0,A.BX)(S.or,{fullWidth:!0,children:[(0,A.tZ)(C.YY,{}),(0,A.BX)(s.Fragment,{children:[(0,A.tZ)(kt,{children:e}),(0,A.tZ)(yt,{...t})]})]})})]})})}St.displayName="StarfishLanding";const kt=(0,j.Z)("div",{target:"e160gsn70"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,P.D)(2),";margin-bottom:",(0,P.D)(2),";@media (min-width: ",(t=>t.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr auto;}");function Pt(t){let{selection:e,location:r,router:i}=t;const h=(0,d.Z)(),b=(0,u.Z)(),j=(0,s.useRef)(!1),S=(0,m.Z)(e.datetime),k=(0,p.gp)(b),P=function(t){let{withStaticFilters:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const{query:s}=t,i=s.start&&s.end,n=(0,Z.ro)(s.sort,"-time_spent_percentage"),a={id:void 0,name:(0,c.t)("Performance"),query:"event.type:transaction has:http.method transaction.op:http.server",fields:["transaction","http.method","tps()","tps_percent_change()","p95(transaction.duration)","percentile_percent_change(transaction.duration,0.95)","http_error_count()","http_error_count_percent_change()","time_spent_percentage()","sum(transaction.duration)"],version:2,dataset:v.as.METRICS},o=Array(a.fields.length).fill(g.z7);o[a.fields.length-1]="110",a.widths=o,s.statsPeriod||i||(a.range=_(r)),a.orderby=n;const l=(0,Z.ro)(s.query,"");return a.query=`${a.query} ${function(t,e){const r=new y.MY(t);if(r.freeText.length>0){const t=r.freeText.join(" ");r.setFilterValues("transaction",[(0,f.D)(t)],!1),r.freeText=[]}return e&&(r.tokens=r.tokens.filter((t=>t.key&&w.includes(t.key)))),r.formatString()}(l,e)}`,x.ZP.fromNewQueryWithLocation(a,t)}(r,{withStaticFilters:k},b);return(0,s.useEffect)((()=>{if(!j.current)return(0,a.QK)(h,b.slug,e),void(j.current=!0);n()(S,e.datetime)||(0,a.QK)(h,b.slug,e)}),[e.datetime,S,e,h,b,r]),(0,A.tZ)(l.Z,{title:(0,c.t)("Web Service"),orgSlug:b.slug,children:(0,A.tZ)(o.Z,{children:(0,A.tZ)(St,{router:i,eventView:P,organization:b,location:r,selection:e,withStaticFilters:k})})})}Pt.displayName="WebServiceView";const Ct=(0,h.Z)(Pt)},"../node_modules/lodash/negate.js":t=>{t.exports=function(t){if("function"!=typeof t)throw new TypeError("Expected a function");return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}},"../node_modules/lodash/omitBy.js":(t,e,r)=>{var s=r("../node_modules/lodash/_baseIteratee.js"),i=r("../node_modules/lodash/negate.js"),n=r("../node_modules/lodash/pickBy.js");t.exports=function(t,e){return n(t,i(s(e)))}}}]);
//# sourceMappingURL=../sourcemaps/app_views_starfish_views_webServiceView_index_tsx-node_modules_lodash_omitBy_js.c559773946d6a0e0989a9dc8ddc372db.js.map