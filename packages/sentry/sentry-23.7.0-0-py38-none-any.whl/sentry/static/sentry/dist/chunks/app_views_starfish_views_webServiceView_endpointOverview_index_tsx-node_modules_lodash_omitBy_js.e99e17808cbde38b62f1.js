(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_starfish_views_webServiceView_endpointOverview_index_tsx-node_modules_lodash_omitBy_js"],{"./app/components/issues/groupList.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>D});var i=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),n=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),r=s("../node_modules/react-router/es/index.js"),a=s("../node_modules/lodash/isEqual.js"),o=s.n(a),d=s("../node_modules/lodash/omit.js"),p=s.n(d),l=s("../node_modules/query-string/index.js"),u=s("./app/actionCreators/members.tsx"),c=s("./app/components/emptyStateWarning.tsx"),m=s("./app/components/loadingError.tsx"),h=s("./app/components/loadingIndicator.tsx"),g=s("./app/components/pagination.tsx"),f=s("./app/components/panels/panel.tsx"),y=s("./app/components/panels/panelBody.tsx"),v=s("./app/components/replays/issuesReplayCountProvider.tsx"),x=s("./app/components/searchSyntax/parser.tsx"),w=s("./app/components/searchSyntax/utils.tsx"),Z=s("./app/components/stream/group.tsx"),_=s("./app/locale.tsx"),b=s("./app/stores/groupStore.tsx"),S=s("./app/utils/withApi.tsx"),k=s("./app/utils/withSentryRouter.tsx"),P=s("./app/views/alerts/rules/metric/details/relatedIssuesNotAvailable.tsx"),C=s("./app/components/issues/groupListHeader.tsx"),L=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class A extends n.Component{constructor(){super(...arguments),(0,i.Z)(this,"state",{loading:!0,error:!1,errorData:null,groups:[],pageLinks:null}),(0,i.Z)(this,"listener",b.Z.listen((()=>this.onGroupChange()),void 0)),(0,i.Z)(this,"fetchData",(async()=>{b.Z.loadInitialData([]);const{api:e,orgId:t,queryParams:s}=this.props;e.clear(),this.setState({loading:!0,error:!1,errorData:null}),(0,u.MA)(e,t).then((e=>{this.setState({memberList:(0,u.M4)(e)})}));const i=this.getGroupListEndpoint(),n=(0,x.UG)((s??this.getQueryParams()).query);if(n&&(0,w.ly)({tree:n,noResultValue:!1,visitorTest:e=>{let{token:t,returnResult:s}=e;return t.type===x.WU.LOGIC_BOOLEAN?s(!0):null}}))this.setState({error:!0,errorData:{detail:P.H},loading:!1});else try{const[t,,s]=await e.requestPromise(i,{includeAllArgs:!0});b.Z.add(t),this.setState({error:!1,errorData:null,loading:!1,pageLinks:s?.getResponseHeader("Link")??null},(()=>{this.props.onFetchSuccess?.(this.state,this.handleCursorChange)}))}catch(e){this.setState({error:!0,errorData:e.responseJSON,loading:!1})}}))}componentDidMount(){this.fetchData()}shouldComponentUpdate(e,t){return!o()(this.state,t)||e.endpointPath!==this.props.endpointPath||e.query!==this.props.query||!o()(e.queryParams,this.props.queryParams)}componentDidUpdate(e){const t=["end"];e.orgId===this.props.orgId&&e.endpointPath===this.props.endpointPath&&e.query===this.props.query&&o()(p()(e.queryParams,t),p()(this.props.queryParams,t))||this.fetchData()}componentWillUnmount(){b.Z.reset(),this.listener?.()}getGroupListEndpoint(){const{orgId:e,endpointPath:t,queryParams:s}=this.props,i=t??`/organizations/${e}/issues/`,n=s??this.getQueryParams();return`${i}?${l.stringify(n)}`}getQueryParams(){const{location:e,query:t}=this.props,s=e.query;return s.limit=50,s.sort="new",s.query=t,s}handleCursorChange(e,t,s,i){const n=parseInt(s.page,10);let a=isNaN(n)?i:n+i;a<=0&&(e=void 0,a=void 0),r.browserHistory.push({pathname:t,query:{...s,cursor:e,page:a}})}onGroupChange(){const e=b.Z.getAllItems();o()(e,this.state.groups)||this.setState({groups:e})}render(){const{canSelectGroups:e,withChart:t,withColumns:s,renderEmptyMessage:i,renderErrorMessage:n,withPagination:r,useFilteredStats:a,useTintRow:o,customStatsPeriod:d,queryParams:p,queryFilterDescription:l,narrowGroups:u,source:x,query:w}=this.props,{loading:b,error:S,errorData:k,groups:P,memberList:A,pageLinks:D}=this.state;if(b)return(0,L.tZ)(h.Z,{});if(S)return"function"==typeof n&&k?n(k,this.fetchData):(0,L.tZ)(m.Z,{onRetry:this.fetchData});if(0===P.length)return"function"==typeof i?i():(0,L.tZ)(f.Z,{children:(0,L.tZ)(y.Z,{children:(0,L.tZ)(c.Z,{children:(0,L.tZ)("p",{children:(0,_.t)("There don't seem to be any events fitting the query.")})})})});const j="auto"===p?.groupStatsPeriod?p?.groupStatsPeriod:Z.g;return(0,L.BX)(v.Z,{groupIds:P.map((e=>{let{id:t}=e;return t})),children:[(0,L.BX)(f.Z,{children:[(0,L.tZ)(C.Z,{withChart:!!t,narrowGroups:u,withColumns:s}),(0,L.tZ)(y.Z,{children:P.map((i=>{let{id:n,project:r}=i;const p=A?.hasOwnProperty(r.slug)?A[r.slug]:void 0;return(0,L.tZ)(Z.Z,{id:n,canSelect:e,withChart:t,withColumns:s,memberList:p,useFilteredStats:a,useTintRow:o,customStatsPeriod:d,statsPeriod:j,queryFilterDescription:l,narrowGroups:u,source:x,query:w},n)}))})]}),r&&(0,L.tZ)(g.Z,{pageLinks:D,onCursor:this.handleCursorChange})]})}}A.displayName="GroupList",(0,i.Z)(A,"defaultProps",{canSelectGroups:!0,withChart:!0,withPagination:!0,useFilteredStats:!0,useTintRow:!0,narrowGroups:!1,withColumns:["graph","event","users","assignee"]});const D=(0,S.Z)((0,k.Z)(A))},"./app/components/performance/layouts.tsx":(e,t,s)=>{"use strict";s.d(t,{c:()=>r});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/styles/space.tsx");const r=(0,i.Z)("div",{target:"eufzkx60"})("display:grid;grid-template-columns:1fr;grid-column-gap:",(0,n.D)(2),";grid-row-gap:",(0,n.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-columns:repeat(2, 1fr);}@media (min-width: ",(e=>e.theme.breakpoints.medium),"){",(e=>e.columns?`\n    grid-template-columns: repeat(${e.columns}, 1fr);\n    `:`\n    grid-template-columns: repeat(auto-fit, minmax(${e.minSize}px, 1fr));\n    `),";}")},"./app/views/alerts/rules/metric/details/relatedIssuesNotAvailable.tsx":(e,t,s)=>{"use strict";s.d(t,{H:()=>p,z:()=>l});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/components/acl/feature.tsx"),r=s("./app/components/alert.tsx"),a=s("./app/components/button.tsx"),o=s("./app/components/panels/panel.tsx"),d=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const p='Error parsing search query: Boolean statements containing "OR" or "AND" are not supported in this search';function l(e){let{buttonTo:t,buttonText:s}=e;return(0,d.tZ)(u,{type:"info",showIcon:!0,trailingItems:(0,d.tZ)(n.Z,{features:["discover-basic"],children:(0,d.tZ)(a.zx,{priority:"default",size:"xs",to:t,children:s})}),children:(0,d.tZ)("div",{"data-test-id":"loading-error-message",children:"Related Issues unavailable for this alert."})})}l.displayName="RelatedIssuesNotAvailable";const u=(0,i.Z)(r.bZ,{target:"e1qw7yyr0"})(o.Z," &{border-radius:0;border-width:1px 0;}")},"./app/views/starfish/components/samplesTable/common.tsx":(e,t,s)=>{"use strict";s.d(t,{f:()=>d,k:()=>p});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=s("./app/locale.tsx"),r=s("./app/utils/formatters.tsx"),a=s("./app/views/starfish/components/textAlign.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function d(e){let{duration:t,p95:s,containerProps:i}=e;const d=t-s;if(p(t,s))return(0,o.tZ)(a.Dq,{...i,children:(0,n.t)("Near baseline")});const u=(0,r.g9)(d/1e3,2,!0,!0),c=d>0?`+${u} above`:`${u} below`;return(0,o.tZ)(l,{...i,value:d,children:c})}d.displayName="DurationComparisonCell";const p=(e,t)=>{const s=.03*t;return Math.abs(e-t)<s},l=(0,i.Z)("span",{target:"e1tr2orr0"})("color:",(e=>0===e.value?e.theme.subText:e.value<0?e.theme.green400:e.theme.red400),";text-align:right;")},"./app/views/starfish/components/tableCells/renderHeadCell.tsx":(e,t,s)=>{"use strict";s.d(t,{W:()=>l,q:()=>p});var i=s("./app/components/gridEditable/sortLink.tsx"),n=s("./app/utils/discover/fields.tsx"),r=s("./app/views/starfish/types.tsx"),a=s("./app/views/starfish/views/queryParameters.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const{SPAN_SELF_TIME:d}=r.SpanMetricsFields,p=new Set([`p95(${d})`,`percentile_percent_change(${d}, 0.95)`,"sps()","sps_percent_change()","time_spent_percentage()","time_spent_percentage(local)","http_error_count()","http_error_count_percent_change()"]),l=e=>{let{column:t,location:s,sort:n}=e;const{key:r,name:d}=t,l=u(r);let c="desc";n?.field===t.key&&"desc"===n.kind&&(c="asc");const m=`${"desc"===c?"-":""}${r}`;return(0,o.tZ)(i.Z,{align:l,canSort:Boolean(s&&n&&p.has(r)),direction:n?.field===t.key?n.kind:void 0,title:d,generateSortLink:()=>({...s,query:{...s?.query,[a.o.SORT]:m}})})};l.displayName="renderHeadCell";const u=e=>{const t=(0,n.dL)(e);if(t){const s=(0,n._4)(t.name,t.arguments[0]);if(s)return(0,n.qG)(e,s)}return"left"}},"./app/views/starfish/utils/buildEventViewQuery.tsx":(e,t,s)=>{"use strict";s.d(t,{$:()=>c}),s("../node_modules/core-js/modules/es.array.push.js");var i=s("./app/utils.tsx"),n=s("./app/views/starfish/types.tsx"),r=s("./app/views/starfish/views/webServiceView/spanGroupBreakdownContainer.tsx");const{SPAN_DESCRIPTION:a,SPAN_OP:o,SPAN_DOMAIN:d,SPAN_ACTION:p,SPAN_MODULE:l}=n.SpanMetricsFields,u=[o,d,p,`!${l}`,"!span.category"];function c(e){let{moduleName:t,location:s,transaction:d,method:p,spanCategory:c}=e;const{query:m}=s,h=Object.keys(m).filter((e=>u.includes(e))).filter((e=>Boolean(m[e]))).map((e=>{const t=m[e],s=Array.isArray(t);if("!span.category"===e&&s&&t.includes("db")){const e=t.filter((e=>"db"!==e));return`(!span.category:db OR ${o}:db.redis) !span.category:[${e.join(",")}]`}return`${e}:${s?`[${t}]`:t}`}));return h.push(`has:${a}`),t!==n.rA.ALL&&h.push(`${l}:${t}`),t===n.rA.DB&&h.push(`!${o}:db.redis`),(0,i.ri)(c)&&(c===r.sZ?h.push("!has:span.category"):"Other"!==c&&h.push(`span.category:${c}`)),d&&h.push(`transaction:${d}`),p&&h.push(`transaction.method:${p}`),h}},"./app/views/starfish/utils/extractRoute.tsx":(e,t,s)=>{"use strict";function i(e){return e.pathname.match(/^\/starfish\/api\//)?"api":e.pathname.match(/^\/starfish\/database\//)?"database":e.pathname.match(/^\/starfish\/endpoint-overview\//)?"endpoint-overview":null}s.d(t,{G:()=>i})},"./app/views/starfish/utils/getDateConditions.tsx":(e,t,s)=>{"use strict";s.d(t,{x:()=>r});var i=s("./app/components/organizations/pageFilters/parse.tsx"),n=s("./app/views/starfish/utils/getDateFilters.tsx");const r=e=>{const{startTime:t,endTime:s,statsPeriod:r}=(0,n.t)(e),{start:a,end:o}=(0,i.fK)({start:t.toDate(),end:s.toDate()});return r?{statsPeriod:r}:{start:a,end:o}}},"./app/views/starfish/utils/useSpansQuery.tsx":(e,t,s)=>{"use strict";s.d(t,{zT:()=>h,bB:()=>g,RX:()=>y}),s("../node_modules/core-js/modules/es.error.cause.js"),s("../node_modules/core-js/modules/es.array.push.js");var i=s("../node_modules/moment/moment.js"),n=s.n(i),r=s("./app/utils/discover/discoverQuery.tsx"),a=s("./app/utils/discover/eventView.tsx"),o=s("./app/utils/discover/genericDiscoverQuery.tsx"),d=s("./app/utils/useLocation.tsx"),p=s("./app/utils/useOrganization.tsx"),l=s("./app/utils/usePageFilters.tsx"),u=s("./app/views/starfish/utils/retryHandlers.tsx"),c=s("../node_modules/react/index.js"),m=s("./app/utils/analytics.tsx");const h="YYYY-MM-DDTHH:mm:ssZ";function g(e){let{eventView:t,initialData:s,limit:i,enabled:n,referrer:r="use-spans-query",cursor:a}=e;const o=(t?.yAxis?.length??0)>0?f:y,{isReady:d}=(0,l.Z)();if(t){const e=o({eventView:t,initialData:s,limit:i,enabled:(n||void 0===n)&&d,referrer:r,cursor:a});return function(e,t){let{isLoading:s,statusCode:i}=t;const[n,r]=(0,c.useState)(null),[a,o]=(0,c.useState)(!1),d=(0,p.Z)();(0,c.useEffect)((()=>{if(s)null===n&&(r(Date.now()),o(!1));else if(!a&&(o(!0),n)){const e=Date.now();(0,m.Gi)("starfish.request",{organization:d,duration:e-n,statusCode:i}),r(null)}}),[a,e,n,d,s,i])}(t,e),e}throw new Error("eventView argument must be defined when Starfish useDiscover is true")}function f(e){let{eventView:t,enabled:s,initialData:i,referrer:r,cursor:c}=e;const m=(0,d.T)(),g=(0,p.Z)(),{isReady:f}=(0,l.Z)(),y=(0,o.JC)({route:"events-stats",eventView:t,location:m,orgSlug:g.slug,getRequestPayload:()=>({...t.getEventsAPIPayload(m),yAxis:t.yAxis,topEvents:t.topEvents,excludeOther:0,partial:1,orderby:t.sorts?.[0]?(0,a.uZ)(t.sorts?.[0]):void 0,interval:t.interval,cursor:c}),options:{enabled:s&&f,refetchOnWindowFocus:!1,retry:u.V,retryDelay:u.P,staleTime:1/0},referrer:r}),w=y.isLoading&&i?i:function(e,t){if(!t.yAxis)return[];let s=[];const i=t.yAxis&&("string"==typeof t.yAxis||1===t.yAxis.length),r="string"==typeof t.yAxis?t.yAxis:t.yAxis[0];if(e.data){const t=v(e,i?r:"count").map((e=>({interval:n()(1e3*parseInt(e.interval,10)).format(h),[r]:e[r],group:e.group})));return t}return Object.keys(e).forEach((t=>{e[t].data?s=x(s,v(e[t],i?r:t)):Object.keys(e[t]).forEach((i=>{"order"!==i&&(s=x(s,v(e[t][i],i,t)))}))})),s.map((e=>({...e,interval:n()(1e3*parseInt(e.interval,10)).format(h)})))}(y.data,t);return{...y,data:w,meta:y.data?.meta}}function y(e){let{eventView:t,initialData:s,enabled:i,referrer:n,limit:a,cursor:o}=e;const c=(0,d.T)(),m=(0,p.Z)(),{isReady:h}=(0,l.Z)(),g=(0,r._)({eventView:t,orgSlug:m.slug,location:c,referrer:n,cursor:o,limit:a,options:{enabled:i&&h,refetchOnWindowFocus:!1,retry:u.V,retryDelay:u.P,staleTime:1/0}}),f=g.data?.meta;f&&(f.fields["sps()"]="rate",f.units["sps()"]="1/second");const y=g.isLoading&&s?s:g.data?.data;return{...g,data:y,meta:f}}function v(e,t,s){const i=[];return e.data.forEach((e=>{let[n,[{count:r}]]=e;const a=i.find((e=>e.interval===n&&(!s||e.group===s)));a?a[t]=r:i.push({interval:n,[t]:r,group:s})})),i}function x(e,t){const s=JSON.parse(JSON.stringify(e));return t.forEach((e=>{let{interval:t,group:i,...n}=e;const r=s.find((e=>e.interval===t&&(!i||e.group===i)));r?Object.keys(n).forEach((e=>{r[e]=n[e]})):s.push({interval:t,group:i,...n})})),s}},"./app/views/starfish/views/queryParameters.tsx":(e,t,s)=>{"use strict";let i;s.d(t,{o:()=>i}),function(e){e.CURSOR="spansCursor",e.SORT="spansSort"}(i||(i={}))},"./app/views/starfish/views/spans/spansTable.tsx":(e,t,s)=>{"use strict";s.d(t,{Z:()=>R,k:()=>B}),s("../node_modules/core-js/modules/es.array.push.js");var i=s("../node_modules/react/index.js"),n=s("../node_modules/react-router/es/index.js"),r=s("../node_modules/query-string/index.js"),a=s("./app/components/gridEditable/index.tsx"),o=s("./app/components/links/link.tsx"),d=s("./app/components/pagination.tsx"),p=s("./app/utils.tsx"),l=s("./app/utils/discover/fieldRenderers.tsx"),u=s("./app/utils/performanceForSentry/index.tsx"),c=s("./app/utils/queryString.tsx"),m=s("./app/utils/useLocation.tsx"),h=s("./app/utils/useOrganization.tsx"),g=s("./app/views/starfish/components/tableCells/renderHeadCell.tsx"),f=s("./app/views/starfish/components/textAlign.tsx"),y=s("../node_modules/lodash/omit.js"),v=s.n(y),x=s("./app/utils/discover/eventView.tsx"),w=s("./app/utils/discover/types.tsx"),Z=s("./app/views/starfish/types.tsx"),_=s("./app/views/starfish/utils/buildEventViewQuery.tsx"),b=s("./app/views/starfish/utils/useSpansQuery.tsx");const{SPAN_SELF_TIME:S,SPAN_DESCRIPTION:k,SPAN_GROUP:P,SPAN_OP:C,SPAN_DOMAIN:L}=Z.SpanMetricsFields,A=function(e,t,s,i,n,r){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"api.starfish.use-span-list",o=arguments.length>7?arguments[7]:void 0;const d=function(e,t,s,i,n,r){const a=(0,_.$)({moduleName:e,location:t,transaction:s,method:i,spanCategory:n}).filter(Boolean).join(" "),o=[C,P,k,L,"sps()","sps_percent_change()",`sum(${S})`,`p95(${S})`,`percentile_percent_change(${S}, 0.95)`,"http_error_count()","http_error_count_percent_change()"];(0,p.ri)(s)?o.push("time_spent_percentage(local)"):o.push("time_spent_percentage()");const d=x.ZP.fromNewQueryWithLocation({name:"",query:a,fields:o,dataset:w.as.SPANS_METRICS,version:2},v()(t,"span.category","http.method"));return r&&(d.sorts=r),d}(e,(0,m.T)(),t,s,i,n),{isLoading:l,data:u,meta:c,pageLinks:h}=(0,b.RX)({eventView:d,initialData:[],limit:r,referrer:a,cursor:o});return{isLoading:l,data:u,meta:c,pageLinks:h}};var D=s("./app/views/starfish/utils/extractRoute.tsx"),j=s("./app/views/starfish/views/queryParameters.tsx"),T=s("./app/views/starfish/views/spans/types.tsx"),q=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const{SPAN_SELF_TIME:F,SPAN_DESCRIPTION:O,SPAN_DOMAIN:N,SPAN_GROUP:$,SPAN_OP:E}=Z.SpanMetricsFields,I=new Set([`p95(${F})`,`percentile_percent_change(${F}, 0.95)`,"sps()","sps_percent_change()","time_spent_percentage()","time_spent_percentage(local)","http_error_count()","http_error_count_percent_change()"]);function R(e){let{moduleName:t,sort:s,columnOrder:p,spanCategory:y,endpoint:v,method:x,limit:w=25}=e;const _=(0,m.T)(),b=(0,h.Z)(),S=(0,c.ro)(_.query?.[j.o.CURSOR]),{isLoading:k,data:P,meta:C,pageLinks:L}=A(t??Z.rA.ALL,v,x,y,[s],w,"api.starfish.use-span-list",S),T=Boolean(v);return(0,q.tZ)(i.Fragment,{children:(0,q.BX)(u.oF,{id:"SpansTable",hasData:(P?.length??0)>0,isLoading:k,disabled:T,children:[(0,q.tZ)(a.ZP,{isLoading:k,data:P,columnOrder:p??z(t,v),columnSortBy:[{key:s.field,order:s.kind}],grid:{renderHeadCell:e=>(0,g.W)({column:e,sort:s,location:_}),renderBodyCell:(e,t)=>function(e,t,s,i,n,a,d){if(e.key===O){const e={...i.query,endpoint:a,endpointMethod:d};return(0,q.tZ)(f._F,{children:t[$]?(0,q.tZ)(o.Z,{to:`/starfish/${(0,D.G)(i)??"spans"}/span/${t[$]}${e?`?${r.stringify(e)}`:""}`,children:t[O]||"<null>"}):t[O]||"<null>"})}if(!s||!s?.fields)return t[e.key];return(0,l.Js)(e.key,s.fields,!1)(t,{location:i,organization:n,unit:s.units?.[e.key]})}(e,t,C,_,b,v,x)},location:_}),(0,q.tZ)(d.Z,{pageLinks:L,onCursor:(e,t,s)=>{n.browserHistory.push({pathname:t,query:{...s,[j.o.CURSOR]:e}})}})]})})}function z(e,t){const s=function(e){return e===Z.rA.HTTP?"URL":e===Z.rA.DB?"Query":"Description"}(e),i=function(e){return e===Z.rA.HTTP?"Host":e===Z.rA.DB?"Table":"Domain"}(e),n=[{key:E,name:"Operation",width:120},{key:O,name:s,width:a.z7},...e!==Z.rA.ALL?[{key:N,name:i,width:a.z7}]:[],{key:"sps()",name:"Throughput",width:a.z7},{key:"sps_percent_change()",name:T.F.change,width:a.z7},{key:`p95(${F})`,name:T.F.p95,width:a.z7},{key:`percentile_percent_change(${F}, 0.95)`,name:T.F.change,width:a.z7},...e===Z.rA.HTTP?[{key:"http_error_count()",name:T.F.errorCount,width:a.z7},{key:"http_error_count_percent_change()",name:T.F.change,width:a.z7}]:[]];return(0,p.ri)(t)?n.push({key:"time_spent_percentage(local)",name:T.F.timeSpent,width:a.z7}):n.push({key:"time_spent_percentage()",name:T.F.timeSpent,width:a.z7}),n}function B(e){return I.has(e.field)}R.displayName="SpansTable"},"./app/views/starfish/views/webServiceView/endpointOverview/index.tsx":(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ae});var i=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),n=(s("../node_modules/core-js/modules/es.array.push.js"),s("../node_modules/react/index.js")),r=s("../node_modules/react-router/es/index.js"),a=s("../node_modules/query-string/index.js"),o=s("./app/components/breadcrumbs.tsx"),d=s("./app/components/button.tsx"),p=s("./app/components/charts/eventsRequest.tsx"),l=s("./app/components/charts/utils.tsx"),u=s("./app/components/layouts/thirds.tsx"),c=s("./app/components/organizations/pageFilterBar.tsx"),m=s("./app/components/organizations/pageFilters/container.tsx"),h=s("./app/components/performance/layouts.tsx"),g=s("./app/components/placeholder.tsx"),f=s("./app/components/segmentedControl.tsx"),y=s("./app/locale.tsx"),v=s("./app/styles/space.tsx"),x=s("./app/types/index.tsx"),w=s("./app/utils.tsx"),Z=s("./app/utils/discover/charts.tsx"),_=s("./app/utils/discover/discoverQuery.tsx"),b=s("./app/utils/discover/eventView.tsx"),S=s("./app/utils/discover/types.tsx"),k=s("./app/utils/tokenizeSearch.tsx"),P=s("./app/utils/useLocation.tsx"),C=s("./app/utils/useOrganization.tsx"),L=s("./app/utils/usePageFilters.tsx"),A=s("./app/utils/withApi.tsx"),D=s("./app/utils/withDomainRequired.tsx"),j=s("./app/views/performance/transactionSummary/utils.tsx"),T=s("./app/views/starfish/colours.tsx"),q=s("./app/views/starfish/components/chart.tsx"),F=s("./app/views/starfish/components/datePicker.tsx"),O=s("./app/components/dateTime.tsx"),N=s("./app/components/gridEditable/index.tsx"),$=s("./app/components/links/link.tsx"),E=s("./app/components/questionTooltip.tsx"),I=s("./app/utils/discover/fieldRenderers.tsx"),R=s("./app/utils/discover/fields.tsx"),z=s("./app/views/starfish/components/samplesTable/common.tsx");const B=2;var M=s("./app/views/starfish/components/tableCells/durationCell.tsx"),V=s("./app/views/starfish/components/textAlign.tsx"),G=s("./app/views/starfish/views/spans/types.tsx"),X=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function H(e){let{queryConditions:t,sampleFilter:s}=e;const i=(0,P.T)(),r=(0,C.Z)(),a={id:void 0,name:"Endpoint Overview Samples",query:new k.MY(t).formatString(),fields:[],dataset:S.as.DISCOVER,version:2},o=[{key:"id",name:"Event ID",width:100},..."ALL"===s?[{key:"profile_id",name:"Profile ID",width:140},{key:R.zD,name:"Operation Duration",width:180},{key:"timestamp",name:"Timestamp",width:230},{key:"transaction.duration",name:G.F.duration,width:100},{key:"p95_comparison",name:"Compared to P95",width:100}]:[{key:"http.status_code",name:"Response Code",width:N.z7},{key:"transaction.status",name:"Status",width:N.z7},{key:"timestamp",name:"Timestamp",width:230}]],d=b.ZP.fromNewQueryWithLocation(a,i),{isLoading:p,data:l,aggregatesData:u}=function(e){const t=(0,P.T)(),s=(0,C.Z)(),i=[{field:"transaction.duration",kind:"field"},{field:"profile_id",kind:"field"},{field:"timestamp",kind:"field"},{field:"spans.browser",kind:"field"},{field:"spans.db",kind:"field"},{field:"spans.http",kind:"field"},{field:"spans.resource",kind:"field"},{field:"spans.ui",kind:"field"}],n=e.clone().withColumns([{kind:"function",function:["p50","transaction.duration",void 0,void 0]},{kind:"function",function:["p95","transaction.duration",void 0,void 0]}]),{isLoading:r,data:a}=(0,_._)({eventView:n,referrer:"starfish-transaction-summary-sample-events",location:t,orgSlug:s.slug}),o=e.clone().withColumns(i).withSorts([{field:"transaction.duration",kind:"desc"}]);o.additionalConditions=new k.MY(`transaction.duration:>${a?.data?.[0]?.["p95(transaction.duration)"]??0}`);const{isLoading:d,data:p}=(0,_._)({eventView:o,referrer:"starfish-transaction-summary-sample-events",location:t,orgSlug:s.slug,limit:B}),l=e.clone().withColumns(i).withSorts([{field:"transaction.duration",kind:"desc"}]);l.additionalConditions=new k.MY(`transaction.duration:<=${a?.data?.[0]?.["p50(transaction.duration)"]??0}`);const{isLoading:u,data:c}=(0,_._)({eventView:l,referrer:"starfish-transaction-summary-sample-events",location:t,orgSlug:s.slug,limit:B}),m=e.clone().withColumns(i).withSorts([{field:"transaction.duration",kind:"asc"}]);m.additionalConditions=new k.MY(`transaction.duration:<=${a?.data?.[0]?.["p50(transaction.duration)"]??0}`);const{isLoading:h,data:g}=(0,_._)({eventView:m,referrer:"starfish-transaction-summary-sample-events",location:t,orgSlug:s.slug,limit:B});return r||d||u||h?{isLoading:!0,data:[]}:{isLoading:!1,data:[...p?.data??[],...c?.data??[],...g?.data??[]],aggregatesData:a?.data[0]??[]}}(d),{isLoading:c,data:m}=function(e){const t=(0,P.T)(),s=(0,C.Z)();let i=e.clone();i.additionalConditions=new k.MY("http.status_code:[500,501,502,503,504,505,506,507,508,510,511]"),i=i.withColumns([{field:"timestamp",kind:"field"},{field:"http.status_code",kind:"field"},{field:"transaction.status",kind:"field"}]).withSorts([{field:"timestamp",kind:"desc"}]);const{isLoading:n,data:r}=(0,_._)({eventView:i,referrer:"starfish-transaction-summary-sample-events",location:t,orgSlug:s.slug,limit:6});return{isLoading:n,data:r?r.data:[]}}(d);return(0,X.tZ)(N.ZP,{isLoading:"ALL"===s?p:c,data:"ALL"===s?l:m,columnOrder:o,columnSortBy:[],location:i,grid:{renderHeadCell:function(e){return"p95_comparison"===e.key||"transaction.duration"===e.key?(0,X.tZ)(V.Dq,{children:(0,X.tZ)(V._F,{children:e.name})}):e.key===R.zD?(0,X.BX)(n.Fragment,{children:[e.name,(0,X.tZ)(Q,{size:"xs",position:"top",title:(0,y.t)("Span durations are summed over the course of an entire transaction. Any overlapping spans are only counted once.")})]}):(0,X.tZ)(V._F,{children:e.name})},renderBodyCell:function(e,t){return"id"===e.key?(0,X.tZ)($.Z,{to:`/performance/${t["project.name"]}:${t.id}`,children:t.id.slice(0,8)}):"profile_id"===e.key?t.profile_id?(0,X.tZ)($.Z,{to:`/profiling/profile/${t["project.name"]}/${t.profile_id}/flamechart/`,children:t.profile_id.slice(0,8)}):"(no value)":"transaction.duration"===e.key?(0,X.tZ)(M.Z,{milliseconds:t["transaction.duration"]}):"timestamp"===e.key?(0,X.tZ)(O.Z,{date:t[e.key],year:!0,timeZone:!0,seconds:!0}):"p95_comparison"===e.key?(0,X.tZ)(z.f,{duration:t["transaction.duration"],p95:u?.["p95(transaction.duration)"]??0}):e.key===R.zD?(0,I.Js)(e.key,{})(t,{location:i,organization:r,eventView:d}):(0,X.tZ)(V.xe,{children:t[e.key]})}}})}H.displayName="TransactionSamplesTable";const Q=(0,i.Z)(E.Z,{target:"e1g0mid30"})({name:"1u8yswg",styles:"position:relative;left:4px"});var U=s("./app/views/starfish/types.tsx"),W=s("./app/views/starfish/utils/chartValueFormatters/formatThroughput.ts"),Y=s("./app/views/starfish/utils/constants.tsx"),J=s("./app/views/starfish/utils/getDateConditions.tsx"),K=s("./app/views/starfish/views/spans/spansTable.tsx"),ee=s("./app/components/issues/groupList.tsx");function te(e){const{transactionName:t,issueCategory:s,httpMethod:i}=e,r=(0,C.Z)(),a=(0,L.Z)(),{statsPeriod:o,start:d,end:p}=(0,J.x)(a.selection),l=a.selection.projects,u=["is:unresolved",...s?[`issue.category:${s}`]:[""],...t?[`transaction:${t}`]:[""],...i?[`http.method:${i}`]:[""]].join(" "),c=(0,n.useMemo)((()=>{const e=o?{statsPeriod:o}:{start:d,end:p};return{project:l[0],query:u,limit:5,sort:"new",...e}}),[u,o,d,p,l]);return(0,X.tZ)(ee.Z,{orgId:r.slug,withChart:!1,withColumns:[],narrowGroups:!0,endpointPath:`/organizations/${r.slug}/issues/`,query:u,queryParams:c,withPagination:!1,useTintRow:!0,source:"starfish-endpoint-summary"})}te.displayName="IssuesTable";const se=te;var ie=s("./app/views/starfish/views/webServiceView/spanGroupBreakdownContainer.tsx");const ne=5,re=(0,A.Z)(p.Z);function ae(){const e=(0,P.T)(),t=(0,C.Z)(),{endpoint:s,"http.method":i,statsPeriod:p}=e.query,h=s?Array.isArray(s)?s[0]:s:void 0,g=i?Array.isArray(i)?i[0]:i:void 0,v=(0,L.Z)(),[A,O]=(0,n.useState)({spansFilter:U.rA.ALL,samplesFilter:"ALL"}),[N,$]=(0,n.useState)("ALL"),E=["has:http.method","transaction.op:http.server",`transaction:${h}`,`http.method:${g}`],I=new k.MY(E),R={id:void 0,name:(0,y.t)("Endpoint Overview"),query:I.formatString(),fields:["tps()","p95(transaction.duration)","http_error_count()"],dataset:S.as.METRICS,start:v.selection.datetime.start??void 0,end:v.selection.datetime.end??void 0,range:v.selection.datetime.period??void 0,version:2},z=b.ZP.fromNewQueryWithLocation(R,e),{data:B,isLoading:M}=(0,_._)({eventView:z,orgSlug:t.slug,location:e});return(0,q.K4)(),(0,X.tZ)(m.Z,{children:(0,X.BX)(u.T3,{children:[(0,X.tZ)(u.h4,{children:(0,X.BX)(u.oB,{children:[(0,X.tZ)(o.Z,{crumbs:[{label:(0,y.t)("Web Service"),to:(0,D.D)(`/organizations/${t.slug}/starfish/`)},{label:(0,y.t)("Endpoint Overview")}]}),(0,X.tZ)(u.Dx,{children:`${g} ${h}`})]})}),(0,X.BX)(u.uT,{children:[(0,X.tZ)(le,{children:(0,X.tZ)(c.Z,{condensed:!0,children:(0,X.tZ)(F.Z,{})})}),(0,X.BX)(u.or,{children:[(0,X.tZ)(ce,{minSize:200,children:(0,X.tZ)(ie._2,{transaction:h})}),(0,X.tZ)(me,{children:(0,X.BX)(f.s,{size:"xs","aria-label":(0,y.t)("Filter Spans"),value:A.spansFilter,onChange:e=>O({...A,spansFilter:e}),children:[(0,X.tZ)(f.s.Item,{children:(0,y.t)("All Spans")},""),(0,X.tZ)(f.s.Item,{children:(0,y.t)("http")},"http"),(0,X.tZ)(f.s.Item,{children:(0,y.t)("db")},"db")]})}),(0,X.tZ)(oe,{filter:A.spansFilter,transaction:h,method:g}),(0,X.BX)(ue,{children:[(0,X.tZ)(me,{children:(0,X.BX)(f.s,{size:"xs","aria-label":(0,y.t)("Filter events"),value:A.samplesFilter,onChange:e=>O({...A,samplesFilter:e}),children:[(0,X.tZ)(f.s.Item,{children:(0,y.t)("Sample Events")},"ALL"),(0,X.tZ)(f.s.Item,{children:(0,y.t)("5XXs")},"500s")]})}),(0,X.tZ)(H,{queryConditions:E,sampleFilter:A.samplesFilter})]}),(0,X.BX)(me,{children:[(0,X.BX)(f.s,{size:"xs","aria-label":(0,y.t)("Filter issue types"),value:N,onChange:e=>$(e),children:[(0,X.tZ)(f.s.Item,{children:(0,y.t)("All Issues")},"ALL"),(0,X.tZ)(f.s.Item,{children:(0,y.t)("Errors Only")},x.qE.ERROR),(0,X.tZ)(f.s.Item,{children:(0,y.t)("Performance Only")},x.qE.PERFORMANCE)]}),(0,X.tZ)(d.zx,{size:"sm",onClick:()=>{const e=new k.MY([..."ALL"===N?[]:[`issue.category:${N}`],`transaction:${h}`,`http.method:${g}`]);r.browserHistory.push({pathname:`/issues/?${a.stringify({...(0,J.x)(v.selection),query:e.formatString()})}`})},children:(0,y.t)("View All")})]}),(0,X.tZ)(se,{issueCategory:"ALL"===N?void 0:N,httpMethod:g,transactionName:h})]}),(0,X.BX)(u.MF,{children:[(0,X.tZ)(re,{query:I.formatString(),includePrevious:!1,partial:!0,limit:5,interval:(0,l.ZS)(v.selection.datetime,Y.R),includeTransformedData:!0,environment:z.environment,project:z.project,period:z.statsPeriod,referrer:"api.starfish-web-service.starfish-endpoint-overview",start:z.start,end:z.end,organization:t,yAxis:["tps()","http_error_count()","p95(transaction.duration)"],dataset:S.as.METRICS,children:e=>{let{loading:t,results:s}=e;if(!s)return null;const i={seriesName:"Requests",data:s[0].data},r={seriesName:(0,y.t)("Requests"),data:s[2].data};return(0,X.BX)(n.Fragment,{children:[(0,X.tZ)(ge,{children:(0,X.tZ)(he,{children:G.F.p95})}),(0,X.tZ)(de,{isLoading:M,value:(0,w.ri)(B)?(0,y.t)("%sms",B.data[0]["p95(transaction.duration)"].toFixed(2)):void 0}),(0,X.tZ)(q.ZP,{statsPeriod:z.statsPeriod,height:80,data:[r],start:z.start,end:z.end,loading:t,utc:!1,grid:{left:"8px",right:"0",top:"8px",bottom:"0"},disableXAxis:!0,definedAxisTicks:2,isLineChart:!0,chartColors:[T.Tn],tooltipFormatterOptions:{valueFormatter:e=>(0,Z.Ew)(e,"duration")}}),(0,X.tZ)(ge,{children:(0,X.tZ)(he,{children:G.F.throughput})}),(0,X.tZ)(de,{isLoading:M,value:(0,w.ri)(B)?(0,y.t)("%s/s",B.data[0]["tps()"].toFixed(2)):void 0}),(0,X.tZ)(q.ZP,{statsPeriod:p??"24h",height:80,data:[i],start:"",end:"",loading:t,utc:!1,isLineChart:!0,definedAxisTicks:2,disableXAxis:!0,chartColors:[T.SQ],aggregateOutputFormat:"rate",grid:{left:"8px",right:"0",top:"8px",bottom:"0"},tooltipFormatterOptions:{valueFormatter:e=>(0,W.Z)(e)}}),(0,X.tZ)(j.uI,{}),(0,X.tZ)(ge,{children:(0,X.tZ)(he,{children:G.F.errorCount})}),(0,X.tZ)(de,{isLoading:M,value:(0,w.ri)(B)?(0,Z.Ew)(B.data[0]["http_error_count()"],"integer"):void 0}),(0,X.tZ)(q.ZP,{statsPeriod:z.statsPeriod,height:80,data:[s[1]],start:z.start,end:z.end,loading:t,utc:!1,grid:{left:"8px",right:"0",top:"8px",bottom:"0"},definedAxisTicks:2,isLineChart:!0,chartColors:[T.eO]}),(0,X.tZ)(j.uI,{})]})}}),(0,X.tZ)(j.uI,{})]})]})]})})}function oe(e){let{filter:t,transaction:s,method:i}=e;return(0,X.tZ)(K.Z,{moduleName:t??U.rA.ALL,sort:{field:"time_spent_percentage(local)",kind:"desc"},endpoint:s,method:i,limit:ne})}function de(e){let{isLoading:t,value:s}=e;return t?(0,X.tZ)(g.Z,{height:"24px"}):(0,X.tZ)(pe,{children:s})}ae.displayName="EndpointOverview",oe.displayName="SpanMetricsTable",de.displayName="ChartSummaryValue";const pe=(0,i.Z)("div",{target:"e1mmy0la6"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";"),le=(0,i.Z)("div",{target:"e1mmy0la5"})("display:grid;grid-template-rows:auto auto auto;gap:",(0,v.D)(2),";margin-bottom:",(0,v.D)(2),";@media (min-width: ",(e=>e.theme.breakpoints.small),"){grid-template-rows:auto;grid-template-columns:auto 1fr auto;}"),ue=(0,i.Z)("div",{target:"e1mmy0la4"})("padding-bottom:",(0,v.D)(4),";"),ce=(0,i.Z)(h.c,{target:"e1mmy0la3"})("margin-bottom:",(0,v.D)(4),";"),me=(0,i.Z)("div",{target:"e1mmy0la2"})("margin-bottom:",(0,v.D)(2),";display:flex;justify-content:space-between;height:32px;align-items:center;"),he=(0,i.Z)("div",{target:"e1mmy0la1"})((e=>e.theme.text.cardTitle),";"),ge=(0,i.Z)("div",{target:"e1mmy0la0"})("padding:0 ",(0,v.D)(1)," 0 0;min-height:24px;width:100%;display:flex;align-items:center;justify-content:space-between;")},"../node_modules/lodash/negate.js":e=>{e.exports=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}},"../node_modules/lodash/omitBy.js":(e,t,s)=>{var i=s("../node_modules/lodash/_baseIteratee.js"),n=s("../node_modules/lodash/negate.js"),r=s("../node_modules/lodash/pickBy.js");e.exports=function(e,t){return r(e,n(i(t)))}}}]);
//# sourceMappingURL=../sourcemaps/app_views_starfish_views_webServiceView_endpointOverview_index_tsx-node_modules_lodash_omitBy_js.c9cb1ff5007eb9b1476af99b60d38b66.js.map