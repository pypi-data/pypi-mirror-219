[tox]
isolated_build = True
envlist = py38, py39, py310
skip_missing_interpreters = True

[testenv]
deps = pytest
commands =
    python --version # For sanity
    pytest {posargs}

[testenv:bump2version]
skip_install = true
deps = bump2version
commands =
    python --version # For sanity
    bump2version --verbose {posargs}

[testenv:dist]
skip_install = true
deps = build
commands =
    python --version # For sanity
    python -m build

[testenv:isort]
skip_install = true
deps = isort
commands =
    python --version # For sanity
    isort --atomic src/ tests/

[testenv:pypi-upload]
skip_install = true
deps = twine
setenv =
    TWINE_USERNAME={env:PYPI_USERNAME}
    TWINE_PASSWORD={env:PYPI_PASSWORD}
commands = twine upload {posargs} dist/*

[testenv:twine-check]
skip_install = true
deps = twine
commands = twine check dist/*

[testenv:docs]
skip_install = true
deps = sphinx
commands =
    sphinx-apidoc -f -o "{toxinidir}/docs" "src/fhzz"
    sphinx-build -d "{toxworkdir}/docs_doctree" docs "{toxworkdir}/docs_out" --color -W -bhtml {posargs}

[testenv:flake8]
skip_install = true
deps = flake8
commands =
    flake8 src/ tests/
