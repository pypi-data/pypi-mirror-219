import{g as ie,a as le,s as O,_ as m,r as p,u as ce,b as de,c as pe,d as ue,j as e,e as he,f as me,h as ge,T as fe,i as G,k as xe,l as w,m as K,n as we,o as be,p as ye,q as ve,t as Ce,v as q,w as Ne,F as Se}from"./index-35325410.js";import{u as I}from"./dispatchHooks-85107758.js";import{u as Ee}from"./store-d6cbae01.js";import{D as Q,S as V}from"./Close-d0ff1fdc.js";import{B as M}from"./Button-3149f941.js";import{n as J}from"./index-0223be06.js";function ke(s){return ie("MuiCollapse",s)}le("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const Te=["addEndListener","children","className","collapsedSize","component","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","orientation","style","timeout","TransitionComponent"],Be=s=>{const{orientation:t,classes:o}=s,l={root:["root",`${t}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${t}`],wrapperInner:["wrapperInner",`${t}`]};return me(l,ke,o)},ze=O("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(s,t)=>{const{ownerState:o}=s;return[t.root,t[o.orientation],o.state==="entered"&&t.entered,o.state==="exited"&&!o.in&&o.collapsedSize==="0px"&&t.hidden]}})(({theme:s,ownerState:t})=>m({height:0,overflow:"hidden",transition:s.transitions.create("height")},t.orientation==="horizontal"&&{height:"auto",width:0,transition:s.transitions.create("width")},t.state==="entered"&&m({height:"auto",overflow:"visible"},t.orientation==="horizontal"&&{width:"auto"}),t.state==="exited"&&!t.in&&t.collapsedSize==="0px"&&{visibility:"hidden"})),$e=O("div",{name:"MuiCollapse",slot:"Wrapper",overridesResolver:(s,t)=>t.wrapper})(({ownerState:s})=>m({display:"flex",width:"100%"},s.orientation==="horizontal"&&{width:"auto",height:"100%"})),Pe=O("div",{name:"MuiCollapse",slot:"WrapperInner",overridesResolver:(s,t)=>t.wrapperInner})(({ownerState:s})=>m({width:"100%"},s.orientation==="horizontal"&&{width:"auto",height:"100%"})),X=p.forwardRef(function(t,o){const l=ce({props:t,name:"MuiCollapse"}),{addEndListener:a,children:g,className:c,collapsedSize:d="0px",component:y,easing:b,in:i,onEnter:f,onEntered:$,onEntering:S,onExit:n,onExited:u,onExiting:E,orientation:_="vertical",style:L,timeout:v=ge.standard,TransitionComponent:Y=fe}=l,Z=de(l,Te),P=m({},l,{orientation:_,collapsedSize:d}),k=Be(P),A=pe(),H=p.useRef(),C=p.useRef(null),W=p.useRef(),D=typeof d=="number"?`${d}px`:d,T=_==="horizontal",B=T?"width":"height";p.useEffect(()=>()=>{clearTimeout(H.current)},[]);const R=p.useRef(null),ee=ue(o,R),N=r=>h=>{if(r){const x=R.current;h===void 0?r(x):r(x,h)}},F=()=>C.current?C.current[T?"clientWidth":"clientHeight"]:0,te=N((r,h)=>{C.current&&T&&(C.current.style.position="absolute"),r.style[B]=D,f&&f(r,h)}),ne=N((r,h)=>{const x=F();C.current&&T&&(C.current.style.position="");const{duration:z,easing:j}=G({style:L,timeout:v,easing:b},{mode:"enter"});if(v==="auto"){const U=A.transitions.getAutoHeightDuration(x);r.style.transitionDuration=`${U}ms`,W.current=U}else r.style.transitionDuration=typeof z=="string"?z:`${z}ms`;r.style[B]=`${x}px`,r.style.transitionTimingFunction=j,S&&S(r,h)}),se=N((r,h)=>{r.style[B]="auto",$&&$(r,h)}),re=N(r=>{r.style[B]=`${F()}px`,n&&n(r)}),oe=N(u),ae=N(r=>{const h=F(),{duration:x,easing:z}=G({style:L,timeout:v,easing:b},{mode:"exit"});if(v==="auto"){const j=A.transitions.getAutoHeightDuration(h);r.style.transitionDuration=`${j}ms`,W.current=j}else r.style.transitionDuration=typeof x=="string"?x:`${x}ms`;r.style[B]=D,r.style.transitionTimingFunction=z,E&&E(r)});return e(Y,m({in:i,onEnter:te,onEntered:se,onEntering:ne,onExit:re,onExited:oe,onExiting:ae,addEndListener:r=>{v==="auto"&&(H.current=setTimeout(r,W.current||0)),a&&a(R.current,r)},nodeRef:R,timeout:v==="auto"?null:v},Z,{children:(r,h)=>e(ze,m({as:y,className:he(k.root,c,{entered:k.entered,exited:!i&&D==="0px"&&k.hidden}[r]),style:m({[T?"minWidth":"minHeight"]:D},L),ownerState:m({},P,{state:r}),ref:ee},h,{children:e($e,{ownerState:m({},P,{state:r}),className:k.wrapper,ref:C,children:e(Pe,{ownerState:m({},P,{state:r}),className:k.wrapperInner,children:g})})}))}))});X.muiSupportAuto=!0;const De=X,Re=({onClose:s})=>{const[t,o]=p.useState(""),[l,a]=p.useState(""),[g]=xe(),c=()=>{g({old_password:l,new_password:t}).unwrap().then(d=>{alert("Password changed successfully"),s()}).catch(()=>{alert("Unable to change password")})};return e(Q,{open:!0,onClose:s,children:w("div",{className:"prose-nbx relative  gap-[16px] p-[16px] flex flex-col justify-center items-center w-[500px]",children:[e(V,{onClick:s,className:"stroke-light-neutral-grey-900 absolute right-[8px] top-[8px] scale-[1.2] cursor-pointer"}),e("input",{onChange:d=>{a(d.target.value)},value:l,className:"w-full h-[40px] mt-[32px]",placeholder:"Old password",type:"password"})," ",e("input",{onChange:d=>{o(d.target.value)},value:t,className:"w-full h-[40px]",placeholder:"New Password",type:"password"}),e(M,{disabled:t.length<6||t==="",onClick:()=>{c()},variant:"contained",className:"w-full",children:"Create"})]})})},je=({label:s})=>{var o;const{auth:t}=I();return e("div",{className:`${((o=t==null?void 0:t.selectedChatBot)==null?void 0:o.name)===s?"border-light-primary-blue-400 border-2 bg-light-primary-blue-50":""} p-[8px] cursor-pointer medium400 border border-light-neutral-grey-200 rounded-md bg-light-system-bg-primary`,children:s})},Me=s=>e("svg",{width:20,height:20,fill:"none",xmlns:"http://www.w3.org/2000/svg",...s,children:e("path",{d:"m5 7.5 5 5 5-5",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round"})}),Le=({onDragStart:s,values:t,label:o})=>{const[l,a]=p.useState(!1),g=({displayName:c})=>e("div",{style:{borderLeftColor:J[o]},className:"bg-light-system-bg-primary rounded-md p-[4px] border-l-[2px] medium300",draggable:!0,onDragStart:d=>s(d,JSON.stringify({...t[c],chain:o,displayName:c})),children:c});return e(De,{in:l,collapsedSize:42,children:w("div",{className:"prose-nbx cursor-pointer medium400 border border-light-neutral-grey-200 rounded-md bg-light-system-bg-primary",children:[w("div",{onClick:()=>{a(!l)},className:"p-[8px] flex justify-between items-center",children:[e("span",{className:"capitalize semiBold300",children:o}),e(Me,{style:{stroke:J[o]},className:`${l?"rotate-180":""}`})]}),e("div",{className:"flex flex-col gap-[16px] p-[8px] bg-light-neutral-grey-100",children:Object.keys(t).map((c,d)=>e(g,{displayName:c},d))})]})})},We=({onClose:s})=>{var b;const t=K(),[o,l]=p.useState(""),[a,g]=p.useState("scratch"),[c,d]=p.useState(""),{auth:y}=I();return e(Q,{open:!0,onClose:s,children:w("div",{className:"prose-nbx relative  gap-[16px] p-[16px] flex flex-col justify-center items-center w-[500px]",children:[e(V,{onClick:s,className:"stroke-light-neutral-grey-900 absolute right-[8px] top-[8px] scale-[1.2] cursor-pointer"}),e("input",{onChange:i=>{var f;l((f=i.target.value)==null?void 0:f.replace(" ","_"))},value:o,type:"text",placeholder:"Name",className:"h-[40px] w-full mt-[16px]"}),w("div",{className:"flex justify-between gap-[8px] w-full",children:[e("div",{onClick:()=>{g("scratch")},className:`${a==="scratch"?"border-light-primary-blue-400 bg-light-primary-blue-50":""} p-[16px] w-[50%] border-light-neutral-grey-200 rounded-md border cursor-pointer`,children:"Start from scratch"}),e("div",{onClick:()=>{g("template")},className:`${a!=="scratch"?"border-light-primary-blue-400 bg-light-primary-blue-50":""} p-[16px] w-[50%] border-light-neutral-grey-200 rounded-md border cursor-pointer`,children:"Create from template"})]}),a==="template"?e("div",{className:"bg-light-system-bg-secondary p-[8px] flex flex-col gap-[4px] overflow-scroll",children:(b=Object.values(y==null?void 0:y.templates))==null?void 0:b.map((i,f)=>w("div",{onClick:()=>{d(i==null?void 0:i.id)},className:`${c===(i==null?void 0:i.id)?"border-light-primary-blue-400 bg-light-primary-blue-50":""} cursor-pointer flex flex-col gap-[4px]
                           p-[8px] border rounded-md border-light-neutral-grey-200
                           bg-light-system-bg-primary`,children:[e("span",{className:"semiBold300",children:i==null?void 0:i.name}),e("span",{className:"regular250",children:i==null?void 0:i.description})]},f))}):"",e(M,{disabled:a==="scratch"?!o:!o||!c,onClick:()=>{t(a==="template"?`/ui/dashboard/template?bot=${o}&id=${c}`:`/ui/dashboard/new?bot=${o}`),s()},variant:"contained",className:"w-full",children:"Create"})]})})},Ge=()=>{var S;const[s,t]=p.useState(!1),{flow_id:o}=we(),l=K(),{auth:a}=I(),[g]=be(),c=Ee(),[d]=ye(),[y,b]=p.useState(!1),[i]=ve();p.useEffect(()=>{localStorage.getItem("accessToken")?f():l("/ui/login")},[]);const f=()=>{g({token:a==null?void 0:a.accessToken}).unwrap().then(n=>{var u,E;c(Ce({chatBots:(u=n==null?void 0:n.chatbots)!=null&&u.length?n==null?void 0:n.chatbots:[]})),i!=null&&i.get("id")||(c(q({chatBot:n==null?void 0:n.chatbots[0]})),l(`/ui/dashboard/?id=${((E=n==null?void 0:n.chatbots[0])==null?void 0:E.id)??""}`))}).catch(n=>{console.log(n)}),d({token:localStorage.getItem("accessToken")??""}).unwrap().then(n=>{var u;c(Ne({templates:(u=n==null?void 0:n.templates)!=null&&u.length?n==null?void 0:n.templates:[]}))})},$=(n,u)=>{n.dataTransfer.setData("application/reactflow",u),n.dataTransfer.effectAllowed="move"};return w("div",{className:"relative overflow-hidden w-[250px] min-w-[250px] border-r h-screen shadow-sm bg-light-system-bg-secondary p-[8px] prose-nbx",children:[s?e(We,{onClose:()=>t(!1)}):"",o?e(M,{onClick:()=>l("/ui/dashboard"),variant:"outlined",className:"my-[8px!important]",color:"primary",fullWidth:!0,children:"Go Back"}):e(M,{onClick:()=>t(!0),variant:"contained",className:"my-[8px!important]",color:"primary",fullWidth:!0,children:"New Bot"}),e("div",{className:"overflow-scroll max-h-[calc(100%-120px)]",children:o?e("div",{className:"flex flex-col gap-[8px]",children:Object.keys(a==null?void 0:a.components).map((n,u)=>e(Le,{label:n,onDragStart:$,values:a==null?void 0:a.components[n]},u))}):e(Se,{children:w("div",{className:"flex flex-col gap-[8px]",children:[e("span",{className:"semiBold250 text-light-neutral-grey-900",children:"Bots"}),(S=Object.values((a==null?void 0:a.chatBots)??[]))==null?void 0:S.map((n,u)=>e("div",{onClick:()=>{c(q({chatBot:n})),l(`/ui/dashboard/?id=${(n==null?void 0:n.id)??""}`)},children:e(je,{label:n==null?void 0:n.name},u)},u))]})})}),w("div",{className:"h-[60px] absolute bottom-0 flex flex-col gap-[4px]",children:[e("span",{className:"medium400 cursor-pointer",onClick:()=>{b(!0)},children:"Change Password"}),e("span",{onClick:()=>{localStorage.clear(),l("/ui/login")},className:"medium400 cursor-pointer",children:"Log Out"})]}),y?e(Re,{onClose:()=>{b(!1)}}):""]})};export{Ge as default};
